DROP TABLE PARTICIPATED
CREATE TABLE PERSON
(
DRIVER_ID VARCHAR(10) PRIMARY KEY,
NAME VARCHAR(50),
ADDRESS VARCHAR(100)
);

CREATE TABLE CAR
(
REGNO VARCHAR(10) PRIMARY KEY,
MODEL VARCHAR(100),
YEAR INT
);

CREATE TABLE ACCIDENT
(
REPORT_NUMBER INT PRIMARY KEY,
ACCD_DATE DATE,
LOCATION VARCHAR(100)
);

CREATE TABLE OWNS
(
DRIVER_ID VARCHAR(10),
REGNO VARCHAR(10),
FOREIGN KEY (DRIVER_ID) REFERENCES PERSON(DRIVER_ID),
FOREIGN KEY (REGNO) REFERENCES CAR(REGNO)
);

CREATE TABLE PARTICIPATED
(
DRIVER_ID VARCHAR(10),
REGNO VARCHAR(10),
REPORT_NUMBER INT,
DAMAGE_AMOUNT INT,
FOREIGN KEY (DRIVER_ID) REFERENCES PERSON(DRIVER_ID),
FOREIGN KEY (REGNO) REFERENCES CAR(REGNO),
FOREIGN KEY (REPORT_NUMBER) REFERENCES ACCIDENT(REPORT_NUMBER)
);


INSERT INTO PERSON VALUES
('D001','AMAR','22 MODEL TOWN'),
('D002','DEEP','SURESH NAGAR'),
('D003','ROHAN','1003 AWALGATE'),
('D004','REHMAN','3 BALTANA')
;

SELECT * FROM PERSON












INSERT INTO CAR VALUES
('CH01A1212','ALTO',2008),
('CH02BN3312','RANGEROVER',2016),
('CH02BN0012','BALENO',2016),
('PAH312','BMW 7',2018),
('PB10A2009','AUDI A8',2008),
('MH01B2007','ALTRUS',2017)
;

SELECT * FROM CAR








INSERT INTO ACCIDENT VALUES
(401,'2018-12-23','MUMBAI'),
(402,'2017-12-28','MANGALORE'),
(403,'2017-02-06','CHENNAI'),
(404,'2016-12-11','DELHI'),
(405,'2016-01-20','MUMBAI'),
(406,'2015-02-02','DELHI')
;





SELECT * FROM ACCIDENT





INSERT INTO OWNS VALUES
('D001','CH01A1212'),
('D001','CH02BN3312'),
('D002','CH02BN0012'),
('D003','PAH312'),
('D004','PB10A2009')
;





SELECT * FROM OWNS






INSERT INTO PARTICIPATED VALUES
('D001','CH01A1212',401,20000),
('D001','CH02BN3312',402,550000),
('D002','CH02BN0012',403,30000),
('D003','PAH312',404,50999),
('D004','PB10A2009',405,250000)
;


SELECT * FROM PARTICIPATED







UPDATE PARTICIPATED 
SET DAMAGE_AMOUNT=25000
WHERE REPORT_NUMBER=402;

INSERT INTO ACCIDENT VALUES
(407,'2019-02-20','CHANDIGARH');

SELECT * FROM PARTICIPATED
SELECT * FROM ACCIDENT







SELECT COUNT(DISTINCT DRIVER_ID)  
FROM ACCIDENT AS A, PARTICIPATED AS P 
WHERE A.ACCD_DATE LIKE '2017%' 
AND A.REPORT_NUMBER=P.REPORT_NUMBER; 






SELECT MODEL,COUNT(*) 
FROM CAR AS C, PARTICIPATED AS P 
WHERE C.REGNO=P.REGNO 
GROUP BY MODEL;










SELECT MODEL,YEAR(ACCD_DATE) 
FROM CAR AS C,ACCIDENT AS A,PARTICIPATED AS P 
WHERE C.REGNO=P.REGNO AND P.REPORT_NUMBER=A.REPORT_NUMBER AND P.DAMAGE_AMOUNT > 20000 AND A.LOCATION='MUMBAI';














SELECT NAME,ADDRESS,ACCD_DATE,LOCATION,DAMAGE_AMOUNT 
FROM PERSON AS PE,ACCIDENT AS A, PARTICIPATED AS P 
WHERE PE.DRIVER_ID=P.DRIVER_ID AND A.REPORT_NUMBER=P.REPORT_NUMBER;














UPDATE PARTICIPATED
SET PARTICIPATED.DAMAGE_AMOUNT=10000 
FROM PARTICIPATED, CAR , ACCIDENT
WHERE CAR.REGNO=PARTICIPATED.REGNO AND PARTICIPATED.REPORT_NUMBER=ACCIDENT.REPORT_NUMBER AND ACCIDENT.LOCATION='DELHI' AND CAR.MODEL='BMW 7';

SELECT * FROM PARTICIPATED	










SELECT P1.DRIVER_ID,P1.REGNO,NAME,MODEL 
FROM PARTICIPATED AS P1,PARTICIPATED AS P2,PERSON AS PE, CAR AS C 
WHERE P1.DRIVER_ID=PE.DRIVER_ID AND C.REGNO=P1.REGNO 
AND P1.DRIVER_ID=P2.DRIVER_ID AND P1.REGNO<>P2.REGNO ;











DELETE FROM PARTICIPATED 
WHERE REGNO IN
(SELECT REGNO FROM ACCIDENT AS A,CAR AS C 
WHERE MODEL LIKE 'BALENO' AND A.REPORT_NUMBER=PARTICIPATED.REPORT_NUMBER);

SELECT * FROM PARTICIPATED